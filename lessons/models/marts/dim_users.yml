version: 2

models:
  - name: dim_users
    description: "Set of facts about users that submitted at least one order."
    columns:
      - name: user_id
        description: "The primary key for the table and the unique identifier for a user."
        tests:
          - primary_key:
              severity: error

      - name: user_first_order_date
        description: "The date of the first order for this user"
        tests:
          - not_null

      - name: user_order_count
        description: "The lifetime number of orders for this user"
        dbt_expectations.expect_column_values_to_be_between:
          min_value: 0

      - name: user_total_items_ordered
        description: "The total number of products ordered by this user over their lifetime"
        tests:
          - not_null

      - name: user_returned_order_count
        description: "The number of orders that the user returned over their lifetime."

      - name: user_returned_sale_amount
        description: "The value of orders returned by the user over their lifetime."

      - name: user_total_sale
        description: "The total value of all orders placed by the user over their lifetime."
        tests:
          - not_null

      - name: user_total_profit
        description: "The total profit generated by the user over their lifetime."

      - name: user_total_discount
        description: "The total discount amount applied to the user's orders over their lifetime."

      - name: user_returned_order_rate
        description: "The rate at which the user returns orders."